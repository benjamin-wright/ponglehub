ARTEFACT start
  DEPENDS ON ../..+raw-cluster

ARTEFACT stop
  DEPENDS ON ../../+stop

DOCKERFILE vue
  FILE
    FROM nginx:stable-alpine as production-stage

    COPY ./ /usr/share/nginx/html
    EXPOSE 80
    CMD ["nginx", "-g", "daemon off;"]

  IGNORE
    node_modules

ARTEFACT image
  STEP clean
    COMMAND rm -rf ./dist
  
  STEP install
    COMMAND npm install

  STEP build
    COMMAND npm run build

  STEP image
    DOCKERFILE vue
    CONTEXT ./dist
    TAG localhost:5000/naughts-and-crosses