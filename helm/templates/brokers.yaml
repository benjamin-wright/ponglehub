{{- $root := . }}
{{- range $name, $broker := .Values.eventBrokers }}
---
apiVersion: eventing.knative.dev/v1
kind: Broker
metadata:
  name: {{ $name }}
  namespace: {{ $root.Release.Namespace }}
  annotations:
    eventing.knative.dev/broker.class: MTChannelBasedBroker
spec:
  config:
    apiVersion: v1
    kind: ConfigMap
    name: config-br-default-channel
    namespace: knative-eventing
  delivery:
    retry: 5
    backoffPolicy: exponential
    backoffDelay: "PT1S"
{{- end }}